swagger: '2.0'
info:
  version: 1.0.0
  title: 'Geodatastore'
  description: Geodatastore is a project of PDOK that facilitates governaments to publish geospatial open datasets, a user can upload a dataset and provide minimal metadata, the metadata is then decorated serverside to meet national profile requirements 
host: test.geodatastore.pdok.nl
schemes:
  - https
paths:
  /api/v1/datasets:
    get:
      description: |
        Gets `datasets` objects.
        Optional query params of **q**, **pageSize**, **sortOrder**, **sortBy** determines filter,
        size and order of returned array
        The status parameter indicates if datasets that are publised or draft are returned.
      parameters:
        - name: q
          in: query
          description: a filter used in query
          required: false
          type: string
        - name: sortBy
          in: query
          description: an attribute to use as sort order
          required: false
          type: string
          default: lastModified
          enum: ["title","lastModified"]
        - name: sortOrder
          in: query
          description: order of sort
          required: false
          type: string
          default: Asc
          enum: ["Asc","Desc"]
        - name: pageSize
          in: query
          description: Size of array
          required: false
          type: integer
        - name: status
          in: query
          description: Indicate to filter aither published of non published
          required: false
          default: published
          type: string
          enum: ["published","draft"]
      responses:
        '200':
          description: Successful response
          schema:
            title: ArrayOfDatasets
            type: array
            items:
                $ref: "#/definitions/dataset"
        '500':
          description: Failed response
          schema: 
            title: Message
            type: string
  /api/v1/dataset:
    post:
      description: |
        Create a new dataset
      operationId: addDataset
      consumes:
        - application/json
      produces:
        - application/json
      parameters:  
        - in: formData
          name: title
          type: string
        - in: formData
          name: summary
          type: string
        - in: formData
          name: keywords
          type: array
          items: 
            type: string
        - in: formData
          name: lineage
          type: string
        - in: formData
          name: license
          type: string
        - in: formData
          name: resolution
          type: string
        - in: formData
          name: locationUri
          type: string
        - in: formData
          name: publish
          type: boolean
          description: if draft, indicate if try to publish
        - in: formData
          name: topicCategory
          type: array
          items: 
            type: string
        - in: formData
          name: dataset
          type: file
        - in: formData
          name: thumbnail
          type: file
      responses:
        '200':
          description: Successful response
          schema:
            $ref: "#/definitions/dataset"
        '405':
          description: Invalid input    
  /api/v1/dataset/{id}:
    post:
      description: |
        Update a dataset
      operationId: updateDataset
      consumes:
        - application/json
      produces:
        - application/json
      parameters: 
        - name: id
          in: path
          description: identifier of the dataset
          required: true
          type: string
        - in: formData
          name: title
          type: string
        - in: formData
          name: summary
          type: string
        - in: formData
          name: keywords
          type: array
          items: string
        - in: formData
          name: lineage
          type: string
        - in: formData
          name: license
          type: string
        - in: formData
          name: resolution
          type: string
        - in: formData
          name: locationUri
          type: string
        - in: formData
          name: publish
          type: boolean
          description: if draft, indicate if try to publish
        - in: formData
          name: topicCategory
          type: array
          items: 
            type: string
        - in: formData
          name: dataset
          type: file
        - in: formData
          name: thumbnail
          type: file
      responses:
        '200':
          description: Successful response
          schema:
            $ref: "#/definitions/dataset"
        '405':
          description: Invalid input 
  /api/v1/dataset/{id}:
    delete:
      description: delete a dataset
      operationId: deleteDataset
      parameters:  
        - name: id
          in: path
          description: the id of the Dataset
          required: true
          type: string
      responses:
        '200':
          description: Successful response      
        '404':
          description: Dataset not found 
  /api/v1/dataset/{id}:
    get:
      description: |
        Get `dataset` object.
      parameters:
        - name: id
          in: path
          description: the id of the Dataset
          required: true
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            title: ArrayOfDatasets
            type: array
            items:
              title: Dataset
              type: object
              properties:
                name:
                  type: string
                single:
                  type: boolean
        '404':
          description: Dataset does not exist or no privileges
          schema: 
            title: Message
            type: string
        '500':
          description: Failed response
          schema: 
            title: Message
            type: string
  /api/v1/registries:
    get:
      description: |
        Gets `registry` objects.
      responses:
        '200':
          description: Successful response
          schema:
            title: ArrayOfRegistry
            type: array
            items:
              title: Registry
              type: object
              properties:
                name:
                  type: string
                url:
                  type: string            
  /api/v1/registry/{name}:
    get:
      description: |
        Gets `registry` objects.
        Optional query param of **pageSize** determines
        size of returned array
      parameters:
        - name: name
          in: path
          description: the name of the Registry
          required: true
          type: string
        - name: q
          in: query
          description: a filter used in query
          required: false
          type: string
        - name: pageSize
          in: query
          description: Size of array
          required: false
          type: integer
      responses:
        '200':
          description: Successful response
          schema:
            title: Array of keywords
            type: array
            items:
              title: Keyword
              type: object
              properties:
                uri:
                  type: string
                label:
                  type: string
                bounds:
                  type: array
                  items: 
                    type: number
                  maxItems: 4
                  minItems: 4
        '404':
          description: Registry does not exist
          schema: 
            title: Message
            type: string
definitions:
  dataset:
    type: object
    properties:
      identifier:
        type: string
      title:
        type: string
      summary:
        type: string
      keywords:
        type: array
        items: 
          type: string
      lineage:
        type: string
      license:
        type: string
      resolution:
        type: string
      locationUri:
        type: string
      extent:
        type: array
        items: 
          type: number
        maxItems: 4
        minItems: 4
      location:
        description: the label of the location
        type: string
      publish:
        type: boolean
        description: if draft, indicate if try to publish
      topicCategories:
        type: array
        items: 
          type: string
      valid: 
        type: boolean
        description: indication if all required properties are filled and the dataset can be published
      status:
        type: string
        enum: ["published","draft"]
        description: true if this file has been previously published
      error:
        type: boolean
        description: true if an error occured while processing the request
      messages:
        type: array
        items:
          type: string
        description: if an error occured, this property has additional info about the error
      fileName:
        type: string
        description: the fileName of the uploaded dataset
      thumbnailUri:
        type: string
        description: url of the thumbnail
      changeDate:
        type: string
        format: date
        description: date of latest change of the metadata
      publishDate:
        type: string
        format: date-time
        description: date of publication of the metadata
      
  
    
